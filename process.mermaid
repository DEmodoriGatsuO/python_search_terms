graph TD
    A[開始] --> B{ファイルパスの検証}
    B -->|有効| C[ファイルを開く]
    B -->|無効| D[エラー: 無効なファイルパス]
    C --> E[ファイル内容を読み込む]
    E --> F{単語セットの各単語をチェック}
    F -->|単語が見つかった| G[マッチした単語をリストに追加]
    F -->|単語が見つからない| H{すべての単語をチェック済み?}
    G --> H
    H -->|はい| I{マッチした単語があるか?}
    H -->|いいえ| F
    I -->|はい| J[成功: マッチした単語リストを返す]
    I -->|いいえ| K[失敗: 空のリストを返す]
    D --> L[エラーメッセージを返す]
    J --> M[終了]
    K --> M
    L --> M
